<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Command Center - Professional Edition</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Chart.js with plugins -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    
    <!-- PapaParse for CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <!-- Math.js for calculations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
    
    <!-- XLSX for Excel files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-cyan: #00ffff;
            --primary-pink: #ff0080;
            --primary-green: #78ffd6;
            --primary-purple: #8b5cf6;
            --bg-dark: #0a0a0a;
            --bg-card: #121218;
            --border-glow: rgba(0, 255, 255, 0.3);
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            color: #ffffff;
        }
        
        .font-mono {
            font-family: 'JetBrains Mono', 'Monaco', 'Cascadia Code', monospace;
        }
        
        /* Enhanced animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(120, 255, 214, 0.12) 0%, transparent 60%),
                radial-gradient(circle at 80% 80%, rgba(255, 0, 128, 0.12) 0%, transparent 60%),
                radial-gradient(circle at 40% 20%, rgba(0, 255, 255, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 90% 10%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0a 0%, #1a0f1f 50%, #0f1419 100%);
            z-index: -2;
            animation: backgroundShift 20s ease-in-out infinite;
        }
        
        @keyframes backgroundShift {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(1deg); }
        }
        
        /* Grid overlay */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(0, 255, 255, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 255, 0.02) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: -1;
            animation: gridPulse 10s ease-in-out infinite;
        }
        
        @keyframes gridPulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 0.8; }
        }
        
        /* Enhanced Glass Effects */
        .glass {
            background: linear-gradient(135deg, rgba(18, 18, 24, 0.85) 0%, rgba(25, 25, 35, 0.85) 100%);
            backdrop-filter: blur(25px) saturate(200%);
            -webkit-backdrop-filter: blur(25px) saturate(200%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.15),
                0 0 0 1px rgba(0, 255, 255, 0.1);
        }
        
        .glass-dark {
            background: linear-gradient(135deg, rgba(10, 10, 15, 0.95) 0%, rgba(20, 15, 25, 0.95) 100%);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.7),
                inset 0 1px 0 rgba(255, 255, 255, 0.08),
                0 0 0 1px rgba(0, 255, 255, 0.05);
        }
        
        .glass-premium {
            background: linear-gradient(135deg, rgba(25, 25, 35, 0.9) 0%, rgba(35, 25, 45, 0.9) 100%);
            backdrop-filter: blur(30px) saturate(250%);
            -webkit-backdrop-filter: blur(30px) saturate(250%);
            border: 2px solid transparent;
            background-clip: padding-box;
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 1px rgba(0, 255, 255, 0.2);
            position: relative;
        }
        
        .glass-premium::before {
            content: '';
            position: absolute;
            inset: 0;
            padding: 2px;
            background: linear-gradient(45deg, var(--primary-cyan), var(--primary-pink), var(--primary-green));
            border-radius: inherit;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: xor;
            -webkit-mask-composite: xor;
        }
        
        /* Enhanced Modal System */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        
        .modal {
            background: linear-gradient(135deg, rgba(18, 18, 24, 0.98) 0%, rgba(25, 25, 35, 0.98) 100%);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 1.5rem;
            box-shadow: 
                0 25px 80px rgba(0, 0, 0, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 1px rgba(0, 255, 255, 0.3);
            max-width: 600px;
            width: 100%;
            max-height: 95vh;
            overflow-y: auto;
        }
        
        /* Enhanced Typography */
        .neon-cyan {
            color: var(--primary-cyan);
            text-shadow: 
                0 0 5px rgba(0, 255, 255, 0.5),
                0 0 10px rgba(0, 255, 255, 0.3),
                0 0 20px rgba(0, 255, 255, 0.2);
        }
        
        .neon-pink {
            color: var(--primary-pink);
            text-shadow: 
                0 0 5px rgba(255, 0, 128, 0.5),
                0 0 10px rgba(255, 0, 128, 0.3),
                0 0 20px rgba(255, 0, 128, 0.2);
        }
        
        .neon-green {
            color: var(--primary-green);
            text-shadow: 
                0 0 5px rgba(120, 255, 214, 0.5),
                0 0 10px rgba(120, 255, 214, 0.3),
                0 0 20px rgba(120, 255, 214, 0.2);
        }
        
        .text-gradient {
            background: linear-gradient(45deg, var(--primary-cyan), var(--primary-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Enhanced Animations */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes pulseGlow {
            0%, 100% {
                box-shadow: 0 0 5px rgba(0, 255, 255, 0.3), 0 0 10px rgba(0, 255, 255, 0.2);
            }
            50% {
                box-shadow: 0 0 20px rgba(0, 255, 255, 0.6), 0 0 30px rgba(0, 255, 255, 0.4);
            }
        }
        
        @keyframes dataFlow {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100vw); }
        }
        
        .animate-slide-up {
            animation: slideInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .animate-slide-left {
            animation: slideInLeft 0.5s ease-out;
        }
        
        .animate-fade-scale {
            animation: fadeInScale 0.4s ease-out;
        }
        
        .animate-pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite;
        }
        
        /* Enhanced Loading Spinner */
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(0, 255, 255, 0.1);
            border-radius: 50%;
            border-top: 3px solid var(--primary-cyan);
            animation: spin 1s linear infinite;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
            position: relative;
        }
        
        .spinner::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            bottom: 2px;
            border: 2px solid transparent;
            border-top: 2px solid var(--primary-pink);
            border-radius: 50%;
            animation: spin 1.5s linear infinite reverse;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Enhanced Progress Bars */
        .progress-bar {
            height: 10px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid rgba(0, 255, 255, 0.3);
            position: relative;
        }
        
        .progress-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-cyan), var(--primary-green));
            border-radius: 8px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .progress-fill.danger {
            background: linear-gradient(90deg, var(--primary-pink), #ff6b6b);
            box-shadow: 0 0 15px rgba(255, 0, 128, 0.5);
        }
        
        .progress-fill.warning {
            background: linear-gradient(90deg, #ffd700, #ffab00);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }
        
        /* Enhanced Card Effects */
        .card-hover {
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
        }
        
        .card-hover::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.15), transparent);
            transition: left 0.6s ease;
        }
        
        .card-hover:hover::before {
            left: 100%;
        }
        
        .card-hover:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 
                0 20px 60px rgba(0, 255, 255, 0.25),
                0 0 30px rgba(255, 0, 128, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(0, 255, 255, 0.6);
        }
        
        /* Enhanced Button System */
        .btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-cyan) 0%, #0080ff 100%);
            color: #000;
            box-shadow: 0 4px 20px rgba(0, 255, 255, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0, 255, 255, 0.5);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--primary-pink) 0%, #ff4060 100%);
            color: #fff;
            box-shadow: 0 4px 20px rgba(255, 0, 128, 0.3);
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(255, 0, 128, 0.5);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--primary-cyan);
            border: 2px solid rgba(0, 255, 255, 0.5);
            backdrop-filter: blur(10px);
        }
        
        .btn-outline:hover {
            background: rgba(0, 255, 255, 0.1);
            border-color: var(--primary-cyan);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.4);
            color: #fff;
        }
        
        .btn-ghost {
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .btn-ghost:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        /* Enhanced Form Elements */
        input, select, textarea {
            background: rgba(0, 0, 0, 0.4) !important;
            border: 2px solid rgba(0, 255, 255, 0.2) !important;
            color: #fff !important;
            transition: all 0.3s ease;
            border-radius: 12px;
            padding: 12px 16px;
            font-family: inherit;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-cyan) !important;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
            background: rgba(0, 0, 0, 0.6) !important;
        }
        
        input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        /* Enhanced Tables */
        .table-container {
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(0, 128, 255, 0.1));
            padding: 16px;
            text-align: left;
            font-weight: 600;
            border-bottom: 1px solid rgba(0, 255, 255, 0.3);
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        
        tr:hover td {
            background: rgba(0, 255, 255, 0.05);
        }
        
        /* Enhanced Tab System */
        .tab-active {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.2) 0%, rgba(0, 128, 255, 0.2) 100%);
            border: 2px solid rgba(0, 255, 255, 0.6);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
            color: #fff;
        }
        
        .tab-inactive {
            border: 2px solid transparent;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .tab-inactive:hover {
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.9);
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        /* Enhanced Alerts */
        .alert {
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            border: 1px solid;
            backdrop-filter: blur(10px);
        }
        
        .alert-success {
            background: linear-gradient(135deg, rgba(120, 255, 214, 0.15), rgba(0, 255, 128, 0.15));
            border-color: rgba(120, 255, 214, 0.5);
            box-shadow: 0 8px 30px rgba(120, 255, 214, 0.2);
        }
        
        .alert-warning {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.15), rgba(255, 152, 0, 0.15));
            border-color: rgba(255, 193, 7, 0.5);
            box-shadow: 0 8px 30px rgba(255, 193, 7, 0.2);
        }
        
        .alert-error {
            background: linear-gradient(135deg, rgba(255, 0, 128, 0.15), rgba(255, 64, 96, 0.15));
            border-color: rgba(255, 0, 128, 0.5);
            box-shadow: 0 8px 30px rgba(255, 0, 128, 0.2);
        }
        
        .alert-info {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.15), rgba(0, 128, 255, 0.15));
            border-color: rgba(0, 255, 255, 0.5);
            box-shadow: 0 8px 30px rgba(0, 255, 255, 0.2);
        }
        
        /* Enhanced Chart Container */
        .chart-container {
            position: relative;
            height: 320px;
            width: 100%;
            border-radius: 16px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Dropdown Enhancements */
        .dropdown {
            position: relative;
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: linear-gradient(135deg, rgba(18, 18, 24, 0.98), rgba(25, 25, 35, 0.98));
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 16px;
            padding: 12px;
            min-width: 250px;
            z-index: 100;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            margin-top: 8px;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, var(--primary-cyan), var(--primary-pink));
            border-radius: 6px;
            border: 2px solid rgba(0, 0, 0, 0.3);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, var(--primary-green), var(--primary-cyan));
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .glass, .glass-dark, .glass-premium {
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
            }
            
            .modal {
                margin: 1rem;
                max-height: 90vh;
            }
            
            .card-hover:hover {
                transform: translateY(-4px) scale(1.01);
            }
            
            .chart-container {
                height: 250px;
            }
        }
        
        /* Data flow animation */
        .data-flow {
            position: absolute;
            top: 50%;
            left: 0;
            width: 2px;
            height: 2px;
            background: var(--primary-cyan);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--primary-cyan);
            animation: dataFlow 3s linear infinite;
            opacity: 0.7;
        }
        
        /* Performance optimizations */
        .gpu-accelerated {
            transform: translateZ(0);
            will-change: transform, opacity;
        }
        
        /* Accessibility improvements */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Focus indicators */
        button:focus-visible, input:focus-visible, select:focus-visible {
            outline: 2px solid var(--primary-cyan);
            outline-offset: 2px;
        }
        
        /* Print styles */
        @media print {
            body::before, body::after { display: none; }
            .glass, .glass-dark, .glass-premium { 
                background: white !important; 
                color: black !important;
                border: 1px solid #ccc !important;
                box-shadow: none !important;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef, useCallback, useReducer } = React;
        
        // Enhanced Error Boundary Component
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null, errorInfo: null };
            }
            
            static getDerivedStateFromError(error) {
                return { hasError: true };
            }
            
            componentDidCatch(error, errorInfo) {
                console.error('Application Error:', error, errorInfo);
                this.setState({
                    error,
                    errorInfo
                });
            }
            
            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen bg-gray-900 flex items-center justify-center p-4">
                            <div className="glass-dark rounded-2xl p-8 max-w-lg w-full text-center">
                                <Icon name="alert-triangle" size={48} className="text-red-400 mx-auto mb-4" />
                                <h2 className="text-2xl font-bold text-white mb-4">Something went wrong</h2>
                                <p className="text-gray-400 mb-6">
                                    The application encountered an unexpected error. Please refresh the page to continue.
                                </p>
                                <div className="flex gap-3 justify-center">
                                    <button 
                                        onClick={() => window.location.reload()}
                                        className="btn btn-primary px-6 py-3 rounded-xl"
                                    >
                                        <Icon name="refresh-cw" size={16} className="mr-2" />
                                        Refresh Page
                                    </button>
                                    <button 
                                        onClick={() => this.setState({ hasError: false, error: null, errorInfo: null })}
                                        className="btn btn-outline px-6 py-3 rounded-xl"
                                    >
                                        Try Again
                                    </button>
                                </div>
                                {process.env.NODE_ENV === 'development' && this.state.error && (
                                    <details className="mt-6 text-left">
                                        <summary className="text-red-400 cursor-pointer mb-2">Error Details</summary>
                                        <pre className="text-xs text-gray-500 bg-black/50 p-4 rounded overflow-auto">
                                            {this.state.error.toString()}
                                            {this.state.errorInfo.componentStack}
                                        </pre>
                                    </details>
                                )}
                            </div>
                        </div>
                    );
                }
                
                return this.props.children;
            }
        }
        const Icon = ({ name, className = "", size = 16, ...props }) => {
            const [loaded, setLoaded] = useState(false);
            
            useEffect(() => {
                if (window.lucide && !loaded) {
                    try {
                        // Use requestAnimationFrame to ensure DOM is ready
                        requestAnimationFrame(() => {
                            try {
                                lucide.createIcons();
                                setLoaded(true);
                            } catch (iconError) {
                                console.warn('Failed to create icon:', name, iconError);
                                setLoaded(true); // Prevent infinite retry
                            }
                        });
                    } catch (error) {
                        console.warn('Failed to schedule icon creation:', name, error);
                        setLoaded(true);
                    }
                }
            }, [name, loaded]);
            
            return React.createElement('i', { 
                'data-lucide': name, 
                className: `inline-block ${className}`,
                style: { width: size, height: size },
                ...props
            });
        };
        
        // Enhanced Loading Component
        const LoadingSpinner = ({ size = 'md', text = 'Loading...' }) => {
            const sizeClasses = {
                sm: 'w-6 h-6',
                md: 'w-12 h-12', 
                lg: 'w-16 h-16'
            };
            
            return (
                <div className="flex flex-col items-center justify-center p-8">
                    <div className={`spinner ${sizeClasses[size]} mb-4`}></div>
                    <p className="text-cyan-400 animate-pulse font-medium">{text}</p>
                </div>
            );
        };
        
        // Enhanced Notification System
        const NotificationSystem = ({ notifications, onRemove }) => {
            return (
                <div className="fixed top-4 right-4 z-50 space-y-3 max-w-sm">
                    {notifications.map(notif => (
                        <div 
                            key={notif.id} 
                            className={`animate-slide-up px-6 py-4 rounded-2xl text-white font-medium shadow-2xl backdrop-blur-md border cursor-pointer ${
                                notif.type === 'success' ? 'bg-gradient-to-r from-green-500/90 to-emerald-500/90 border-green-400/50' :
                                notif.type === 'error' ? 'bg-gradient-to-r from-red-500/90 to-pink-500/90 border-red-400/50' :
                                notif.type === 'warning' ? 'bg-gradient-to-r from-yellow-500/90 to-orange-500/90 border-yellow-400/50' : 
                                'bg-gradient-to-r from-blue-500/90 to-cyan-500/90 border-cyan-400/50'
                            }`}
                            onClick={() => onRemove(notif.id)}
                        >
                            <div className="flex items-center gap-3">
                                <Icon 
                                    name={
                                        notif.type === 'success' ? 'check-circle' :
                                        notif.type === 'error' ? 'x-circle' :
                                        notif.type === 'warning' ? 'alert-triangle' : 'info'
                                    } 
                                    size={20}
                                />
                                <div className="flex-1">
                                    <div className="font-semibold">{notif.title || 'Notification'}</div>
                                    <div className="text-sm opacity-90">{notif.message}</div>
                                </div>
                                <Icon name="x" size={16} className="opacity-60 hover:opacity-100" />
                            </div>
                        </div>
                    ))}
                </div>
            );
        };
        
        // Enhanced Modal Component
        const Modal = ({ isOpen, onClose, title, children, size = "md", footerActions }) => {
            const modalRef = useRef(null);
            
            const sizeClasses = {
                sm: "max-w-md",
                md: "max-w-2xl", 
                lg: "max-w-4xl",
                xl: "max-w-6xl",
                full: "max-w-7xl"
            };
            
            useEffect(() => {
                try {
                    if (isOpen) {
                        document.body.style.overflow = 'hidden';
                        modalRef.current?.focus();
                    } else {
                        document.body.style.overflow = 'unset';
                    }
                } catch (modalError) {
                    console.warn('Modal DOM manipulation error:', modalError);
                }
                
                return () => {
                    try {
                        document.body.style.overflow = 'unset';
                    } catch (cleanupError) {
                        console.warn('Modal cleanup error:', cleanupError);
                    }
                };
            }, [isOpen]);
            
            useEffect(() => {
                const handleEscape = (e) => {
                    if (e.key === 'Escape' && isOpen) {
                        onClose();
                    }
                };
                
                document.addEventListener('keydown', handleEscape);
                return () => document.removeEventListener('keydown', handleEscape);
            }, [isOpen, onClose]);
            
            if (!isOpen) return null;
            
            return (
                <div className="modal-backdrop animate-fade-scale" onClick={onClose}>
                    <div 
                        ref={modalRef}
                        className={`modal ${sizeClasses[size]} animate-slide-up`}
                        onClick={(e) => e.stopPropagation()}
                        tabIndex={-1}
                        role="dialog"
                        aria-modal="true"
                        aria-labelledby="modal-title"
                    >
                        <div className="p-8">
                            <div className="flex justify-between items-center mb-6">
                                <h3 id="modal-title" className="text-2xl font-bold text-gradient">{title}</h3>
                                <button
                                    onClick={onClose}
                                    className="p-2 hover:bg-white/10 rounded-xl transition-colors focus:outline-none focus:ring-2 focus:ring-cyan-400"
                                    aria-label="Close modal"
                                >
                                    <Icon name="x" size={24} className="text-gray-400 hover:text-white" />
                                </button>
                            </div>
                            <div className="mb-6">
                                {children}
                            </div>
                            {footerActions && (
                                <div className="flex gap-4 pt-6 border-t border-white/10">
                                    {footerActions}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };
        
        // Enhanced Chart Component with error handling
        const ChartComponent = ({ type, data, options, id, className = "" }) => {
            const canvasRef = useRef(null);
            const chartRef = useRef(null);
            const [error, setError] = useState(null);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                if (!canvasRef.current || !data || !window.Chart) {
                    setLoading(false);
                    return;
                }
                
                try {
                    const ctx = canvasRef.current.getContext('2d');
                    
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }
                    
                    const defaultOptions = {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { 
                                    color: '#00ffff',
                                    font: { family: 'Inter', size: 12 }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(10, 10, 15, 0.95)',
                                titleColor: '#00ffff',
                                bodyColor: '#ffffff',
                                borderColor: '#00ffff',
                                borderWidth: 1,
                                cornerRadius: 8,
                                displayColors: true
                            }
                        },
                        scales: type !== 'doughnut' && type !== 'pie' ? {
                            x: { 
                                ticks: { color: '#78ffd6' }, 
                                grid: { color: 'rgba(0,255,255,0.1)' },
                                border: { color: 'rgba(0,255,255,0.3)' }
                            },
                            y: { 
                                ticks: { color: '#78ffd6' }, 
                                grid: { color: 'rgba(0,255,255,0.1)' },
                                border: { color: 'rgba(0,255,255,0.3)' }
                            }
                        } : undefined,
                        ...options
                    };
                    
                    chartRef.current = new Chart(ctx, {
                        type: type,
                        data: data,
                        options: defaultOptions
                    });
                    
                    setError(null);
                    setLoading(false);
                } catch (err) {
                    console.error('Chart creation error:', err);
                    setError(err.message);
                    setLoading(false);
                }
                
                return () => {
                    try {
                        if (chartRef.current) {
                            chartRef.current.destroy();
                            chartRef.current = null;
                        }
                    } catch (destroyError) {
                        console.warn('Chart cleanup error:', destroyError);
                    }
                };
            }, [type, data, options]);
            
            if (loading) {
                return (
                    <div className="chart-container">
                        <LoadingSpinner text="Loading chart..." />
                    </div>
                );
            }
            
            if (error) {
                return (
                    <div className="chart-container flex items-center justify-center">
                        <div className="text-center text-red-400">
                            <Icon name="alert-triangle" size={48} className="mx-auto mb-4" />
                            <p className="font-medium">Chart Error</p>
                            <p className="text-sm opacity-75">{error}</p>
                        </div>
                    </div>
                );
            }
            
            return (
                <div className={`chart-container ${className}`}>
                    <canvas ref={canvasRef} id={id} aria-label={`${type} chart`}></canvas>
                </div>
            );
        };
        
        // Enhanced Form Components
        const FormField = ({ 
            label, 
            error, 
            required, 
            helpText, 
            children, 
            className = "" 
        }) => (
            <div className={`space-y-2 ${className}`}>
                <label className="block text-sm font-medium text-gray-300">
                    {label}
                    {required && <span className="text-red-400 ml-1">*</span>}
                </label>
                {children}
                {helpText && (
                    <p className="text-xs text-gray-500">{helpText}</p>
                )}
                {error && (
                    <p className="text-xs text-red-400 flex items-center gap-1">
                        <Icon name="alert-circle" size={12} />
                        {error}
                    </p>
                )}
            </div>
        );
        
        // Enhanced Input Component
        const Input = ({ 
            type = "text", 
            placeholder, 
            value, 
            onChange, 
            error,
            icon,
            className = "",
            ...props 
        }) => (
            <div className="relative">
                {icon && (
                    <div className="absolute left-4 top-1/2 transform -translate-y-1/2">
                        <Icon name={icon} size={16} className="text-gray-500" />
                    </div>
                )}
                <input
                    type={type}
                    placeholder={placeholder}
                    value={value}
                    onChange={onChange}
                    className={`w-full ${icon ? 'pl-12' : 'pl-4'} pr-4 py-3 ${error ? 'border-red-400' : ''} ${className}`}
                    {...props}
                />
            </div>
        );
        
        // Transaction Form Component
        const TransactionForm = ({ isOpen, onClose, onSave, editTransaction = null }) => {
            const [formData, setFormData] = useState({
                description: '',
                amount: '',
                category: 'Other',
                type: 'expense',
                date: new Date().toISOString().split('T')[0],
                account: 'Checking',
                notes: '',
                tags: [],
                recurring: false
            });
            
            const [errors, setErrors] = useState({});
            const [isSubmitting, setIsSubmitting] = useState(false);
            
            const categories = [
                { value: 'Food', icon: 'coffee', color: '#78ffd6' },
                { value: 'Housing', icon: 'home', color: '#00ffff' },
                { value: 'Transportation', icon: 'car', color: '#ff0080' },
                { value: 'Entertainment', icon: 'tv', color: '#ff4060' },
                { value: 'Healthcare', icon: 'heart', color: '#ffd700' },
                { value: 'Shopping', icon: 'shopping-bag', color: '#ff00ff' },
                { value: 'Utilities', icon: 'zap', color: '#0080ff' },
                { value: 'Travel', icon: 'plane', color: '#00ff80' },
                { value: 'Education', icon: 'book', color: '#8b5cf6' },
                { value: 'Income', icon: 'dollar-sign', color: '#22c55e' },
                { value: 'Other', icon: 'more-horizontal', color: '#6b7280' }
            ];
            
            useEffect(() => {
                if (editTransaction) {
                    setFormData({
                        ...editTransaction,
                        tags: editTransaction.tags || []
                    });
                } else {
                    setFormData({
                        description: '',
                        amount: '',
                        category: 'Other',
                        type: 'expense',
                        date: new Date().toISOString().split('T')[0],
                        account: 'Checking',
                        notes: '',
                        tags: [],
                        recurring: false
                    });
                }
                setErrors({});
            }, [editTransaction, isOpen]);
            
            const validateForm = () => {
                const newErrors = {};
                
                if (!formData.description.trim()) {
                    newErrors.description = 'Description is required';
                }
                
                if (!formData.amount || isNaN(formData.amount) || parseFloat(formData.amount) <= 0) {
                    newErrors.amount = 'Please enter a valid amount greater than 0';
                }
                
                if (!formData.date) {
                    newErrors.date = 'Date is required';
                }
                
                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (!validateForm()) return;
                
                setIsSubmitting(true);
                
                try {
                    // Simulate API delay
                    await new Promise(resolve => setTimeout(resolve, 800));
                    
                    const transaction = {
                        ...formData,
                        id: editTransaction?.id || `txn_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                        amount: parseFloat(formData.amount),
                        confidence: 95,
                        createdAt: editTransaction?.createdAt || new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };
                    
                    onSave(transaction);
                    onClose();
                } catch (error) {
                    setErrors({ submit: 'Failed to save transaction. Please try again.' });
                } finally {
                    setIsSubmitting(false);
                }
            };
            
            const selectedCategory = categories.find(cat => cat.value === formData.category);
            
            return (
                <Modal 
                    isOpen={isOpen} 
                    onClose={onClose} 
                    title={editTransaction ? "Edit Transaction" : "Add New Transaction"}
                    size="lg"
                    footerActions={[
                        <button 
                            key="cancel"
                            type="button" 
                            onClick={onClose} 
                            className="btn btn-ghost px-6 py-3 rounded-xl"
                            disabled={isSubmitting}
                        >
                            Cancel
                        </button>,
                        <button 
                            key="submit"
                            type="submit" 
                            form="transaction-form"
                            className="btn btn-primary px-6 py-3 rounded-xl"
                            disabled={isSubmitting}
                        >
                            {isSubmitting ? (
                                <>
                                    <div className="w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"></div>
                                    {editTransaction ? 'Updating...' : 'Adding...'}
                                </>
                            ) : (
                                <>
                                    <Icon name={editTransaction ? "edit-2" : "plus"} size={16} className="mr-2" />
                                    {editTransaction ? 'Update Transaction' : 'Add Transaction'}
                                </>
                            )}
                        </button>
                    ]}
                >
                    <form id="transaction-form" onSubmit={handleSubmit} className="space-y-6">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <FormField 
                                label="Description" 
                                required 
                                error={errors.description}
                                className="md:col-span-2"
                            >
                                <Input
                                    type="text"
                                    placeholder="Enter transaction description"
                                    value={formData.description}
                                    onChange={(e) => setFormData({...formData, description: e.target.value})}
                                    error={errors.description}
                                    icon="edit-3"
                                />
                            </FormField>
                            
                            <FormField 
                                label="Amount" 
                                required 
                                error={errors.amount}
                                helpText="Enter the transaction amount"
                            >
                                <Input
                                    type="number"
                                    step="0.01"
                                    placeholder="0.00"
                                    value={formData.amount}
                                    onChange={(e) => setFormData({...formData, amount: e.target.value})}
                                    error={errors.amount}
                                    icon="dollar-sign"
                                />
                            </FormField>
                            
                            <FormField 
                                label="Type" 
                                required
                            >
                                <div className="grid grid-cols-2 gap-3">
                                    {[
                                        { value: 'expense', label: 'Expense', icon: 'minus', color: 'text-red-400' },
                                        { value: 'income', label: 'Income', icon: 'plus', color: 'text-green-400' }
                                    ].map(type => (
                                        <button
                                            key={type.value}
                                            type="button"
                                            onClick={() => setFormData({...formData, type: type.value})}
                                            className={`p-4 rounded-xl border-2 transition-all ${
                                                formData.type === type.value
                                                    ? 'border-cyan-400 bg-cyan-400/10 text-cyan-400'
                                                    : 'border-gray-600 hover:border-gray-500 text-gray-400 hover:text-gray-300'
                                            }`}
                                        >
                                            <Icon name={type.icon} size={20} className={`mx-auto mb-2 ${type.color}`} />
                                            <div className="font-medium">{type.label}</div>
                                        </button>
                                    ))}
                                </div>
                            </FormField>
                            
                            <FormField 
                                label="Category" 
                                required
                            >
                                <div className="grid grid-cols-3 gap-2 max-h-48 overflow-y-auto">
                                    {categories.map(category => (
                                        <button
                                            key={category.value}
                                            type="button"
                                            onClick={() => setFormData({...formData, category: category.value})}
                                            className={`p-3 rounded-xl border transition-all text-center ${
                                                formData.category === category.value
                                                    ? 'border-cyan-400 bg-cyan-400/10 text-cyan-400'
                                                    : 'border-gray-600 hover:border-gray-500 text-gray-400 hover:text-gray-300'
                                            }`}
                                        >
                                            <Icon name={category.icon} size={16} className="mx-auto mb-1" style={{ color: category.color }} />
                                            <div className="text-xs font-medium">{category.value}</div>
                                        </button>
                                    ))}
                                </div>
                            </FormField>
                            
                            <FormField 
                                label="Account" 
                                required
                            >
                                <select
                                    value={formData.account}
                                    onChange={(e) => setFormData({...formData, account: e.target.value})}
                                    className="w-full"
                                >
                                    <option value="Checking"> Checking Account</option>
                                    <option value="Savings"> Savings Account</option>
                                    <option value="Investment"> Investment Account</option>
                                    <option value="Credit Card"> Credit Card</option>
                                    <option value="Cash"> Cash</option>
                                </select>
                            </FormField>
                            
                            <FormField 
                                label="Date" 
                                required 
                                error={errors.date}
                            >
                                <Input
                                    type="date"
                                    value={formData.date}
                                    onChange={(e) => setFormData({...formData, date: e.target.value})}
                                    error={errors.date}
                                    icon="calendar"
                                />
                            </FormField>
                            
                            <FormField 
                                label="Notes" 
                                helpText="Optional additional details"
                                className="md:col-span-2"
                            >
                                <textarea
                                    value={formData.notes}
                                    onChange={(e) => setFormData({...formData, notes: e.target.value})}
                                    className="w-full h-24 resize-none"
                                    placeholder="Add any additional notes or details..."
                                />
                            </FormField>
                            
                            <FormField className="md:col-span-2">
                                <div className="flex items-center gap-3">
                                    <input
                                        type="checkbox"
                                        id="recurring"
                                        checked={formData.recurring}
                                        onChange={(e) => setFormData({...formData, recurring: e.target.checked})}
                                        className="w-5 h-5 rounded border-2 border-cyan-400 text-cyan-400 focus:ring-cyan-400 focus:ring-offset-0"
                                    />
                                    <label htmlFor="recurring" className="text-sm font-medium text-gray-300 flex items-center gap-2">
                                        <Icon name="repeat" size={16} className="text-cyan-400" />
                                        This is a recurring transaction
                                    </label>
                                </div>
                            </FormField>
                        </div>
                        
                        {errors.submit && (
                            <div className="alert alert-error">
                                <Icon name="alert-circle" size={20} className="text-red-400" />
                                <span>{errors.submit}</span>
                            </div>
                        )}
                    </form>
                </Modal>
            );
        };
        
        // Enhanced Main Application
        const FinanceCommandCenter = () => {
            // State Management
            const [activeTab, setActiveTab] = useState('dashboard');
            const [loading, setLoading] = useState(false);
            const [notifications, setNotifications] = useState([]);
            const [searchQuery, setSearchQuery] = useState('');
            
            // Modal states
            const [showTransactionForm, setShowTransactionForm] = useState(false);
            const [editingTransaction, setEditingTransaction] = useState(null);
            const [showFilters, setShowFilters] = useState(false);
            
            // Filter states
            const [filters, setFilters] = useState({
                category: 'all',
                type: 'all',
                dateRange: 'all',
                amountRange: { min: '', max: '' },
                account: 'all'
            });
            
            const [sortBy, setSortBy] = useState('date');
            const [sortOrder, setSortOrder] = useState('desc');
            
            // Financial Data States with sample data
            const [transactions, setTransactions] = useState([
                {
                    id: 'txn_1',
                    date: '2024-01-15',
                    description: 'Whole Foods Market - Weekly Groceries',
                    amount: 127.83,
                    category: 'Food',
                    confidence: 95,
                    type: 'expense',
                    account: 'Checking',
                    notes: 'Weekly grocery shopping',
                    tags: ['groceries', 'organic'],
                    recurring: true,
                    createdAt: '2024-01-15T10:30:00Z',
                    updatedAt: '2024-01-15T10:30:00Z'
                },
                {
                    id: 'txn_2',
                    date: '2024-01-14',
                    description: 'Direct Deposit - Salary',
                    amount: 4200.00,
                    category: 'Income',
                    confidence: 100,
                    type: 'income',
                    account: 'Checking',
                    notes: 'Monthly salary deposit',
                    tags: ['salary'],
                    recurring: true,
                    createdAt: '2024-01-14T09:00:00Z',
                    updatedAt: '2024-01-14T09:00:00Z'
                },
                {
                    id: 'txn_3',
                    date: '2024-01-13',
                    description: 'Netflix Subscription',
                    amount: 15.99,
                    category: 'Entertainment',
                    confidence: 98,
                    type: 'expense',
                    account: 'Credit Card',
                    notes: 'Monthly streaming service',
                    tags: ['streaming', 'subscription'],
                    recurring: true,
                    createdAt: '2024-01-13T08:15:00Z',
                    updatedAt: '2024-01-13T08:15:00Z'
                },
                {
                    id: 'txn_4',
                    date: '2024-01-12',
                    description: 'Shell Gas Station',
                    amount: 52.40,
                    category: 'Transportation',
                    confidence: 92,
                    type: 'expense',
                    account: 'Credit Card',
                    notes: 'Gas fill-up',
                    tags: ['gas', 'car'],
                    recurring: false,
                    createdAt: '2024-01-12T17:45:00Z',
                    updatedAt: '2024-01-12T17:45:00Z'
                },
                {
                    id: 'txn_5',
                    date: '2024-01-11',
                    description: 'Starbucks Coffee',
                    amount: 6.75,
                    category: 'Food',
                    confidence: 89,
                    type: 'expense',
                    account: 'Checking',
                    notes: 'Morning coffee',
                    tags: ['coffee', 'beverage'],
                    recurring: false,
                    createdAt: '2024-01-11T08:30:00Z',
                    updatedAt: '2024-01-11T08:30:00Z'
                }
            ]);
            
            const [accounts] = useState([
                { 
                    id: 'acc_1',
                    name: 'Primary Checking', 
                    balance: 8420.50, 
                    type: 'checking', 
                    number: '****1234',
                    institution: 'Chase Bank',
                    interestRate: 0.01,
                    monthlyChange: 245.30
                },
                { 
                    id: 'acc_2',
                    name: 'High-Yield Savings', 
                    balance: 28780.75, 
                    type: 'savings', 
                    number: '****5678',
                    institution: 'Marcus by Goldman Sachs',
                    interestRate: 4.5,
                    monthlyChange: 1205.45
                },
                { 
                    id: 'acc_3',
                    name: 'Investment Portfolio', 
                    balance: 52250.00, 
                    type: 'investment', 
                    number: '****9012',
                    institution: 'Vanguard',
                    interestRate: 8.2,
                    monthlyChange: 3241.67
                }
            ]);
            
            const [budgetEnvelopes] = useState([
                { category: 'Housing', budget: 2200, spent: 2200, color: '#00ffff', icon: 'home', limit: 2500 },
                { category: 'Food', budget: 700, spent: 523, color: '#78ffd6', icon: 'coffee', limit: 800 },
                { category: 'Transportation', budget: 450, spent: 380, color: '#ff0080', icon: 'car', limit: 500 },
                { category: 'Entertainment', budget: 300, spent: 150, color: '#ff4060', icon: 'tv', limit: 400 },
                { category: 'Healthcare', budget: 250, spent: 175, color: '#ffd700', icon: 'heart', limit: 350 },
                { category: 'Shopping', budget: 400, spent: 220, color: '#ff00ff', icon: 'shopping-bag', limit: 500 },
                { category: 'Utilities', budget: 200, spent: 190, color: '#0080ff', icon: 'zap', limit: 250 },
                { category: 'Savings', budget: 1200, spent: 1200, color: '#00ff80', icon: 'piggy-bank', limit: 1500 }
            ]);
            
            const [investmentPortfolio] = useState([
                { asset: 'US Stocks', value: 31350, target: 60, actual: 0, change: 5.8, allocation: 'Large Cap' },
                { asset: 'International Stocks', value: 10450, target: 20, actual: 0, change: 3.2, allocation: 'Developed Markets' },
                { asset: 'Bonds', value: 7825, target: 15, actual: 0, change: 1.4, allocation: 'Government & Corporate' },
                { asset: 'REITs', value: 2088, target: 4, actual: 0, change: 4.1, allocation: 'Real Estate' },
                { asset: 'Cash', value: 522, target: 1, actual: 0, change: 0.1, allocation: 'Emergency Fund' }
            ]);
            
            const [debts] = useState([
                { id: 'debt_1', name: 'Visa Credit Card', balance: 3240, rate: 18.99, minimum: 150, paid: 300, type: 'credit_card' },
                { id: 'debt_2', name: 'Mastercard', balance: 1890, rate: 21.99, minimum: 75, paid: 150, type: 'credit_card' },
                { id: 'debt_3', name: 'Car Loan', balance: 18500, rate: 4.9, minimum: 385, paid: 400, type: 'auto' },
                { id: 'debt_4', name: 'Student Loan', balance: 32750, rate: 5.5, minimum: 295, paid: 350, type: 'student' },
                { id: 'debt_5', name: 'Mortgage', balance: 245000, rate: 6.75, minimum: 1450, paid: 1650, type: 'mortgage' }
            ]);
            
            // Enhanced notification system
            const addNotification = useCallback((message, type = 'info', title = null) => {
                const id = Date.now() + Math.random();
                const notification = {
                    id,
                    message,
                    type,
                    title,
                    timestamp: new Date().toISOString()
                };
                
                setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                
                // Auto-remove after delay based on type
                const delay = type === 'error' ? 8000 : type === 'warning' ? 6000 : 4000;
                setTimeout(() => {
                    setNotifications(prev => prev.filter(n => n.id !== id));
                }, delay);
            }, []);
            
            const removeNotification = useCallback((id) => {
                setNotifications(prev => prev.filter(n => n.id !== id));
            }, []);
            
            // Transaction management
            const addTransaction = useCallback((transaction) => {
                setTransactions(prev => [transaction, ...prev]);
                addNotification(
                    `Transaction "${transaction.description}" added successfully`,
                    'success',
                    'Transaction Added'
                );
            }, [addNotification]);
            
            const updateTransaction = useCallback((updatedTransaction) => {
                setTransactions(prev => prev.map(t => 
                    t.id === updatedTransaction.id ? updatedTransaction : t
                ));
                addNotification(
                    `Transaction "${updatedTransaction.description}" updated successfully`,
                    'success',
                    'Transaction Updated'
                );
            }, [addNotification]);
            
            const deleteTransaction = useCallback((transactionId) => {
                const transaction = transactions.find(t => t.id === transactionId);
                setTransactions(prev => prev.filter(t => t.id !== transactionId));
                addNotification(
                    `Transaction "${transaction?.description}" deleted successfully`,
                    'success',
                    'Transaction Deleted'
                );
            }, [transactions, addNotification]);
            
            // Enhanced filtering and sorting
            const filteredAndSortedTransactions = useMemo(() => {
                let filtered = transactions;
                
                // Search filter
                if (searchQuery) {
                    const query = searchQuery.toLowerCase();
                    filtered = filtered.filter(t => 
                        t.description.toLowerCase().includes(query) ||
                        t.category.toLowerCase().includes(query) ||
                        t.notes.toLowerCase().includes(query) ||
                        t.tags.some(tag => tag.toLowerCase().includes(query))
                    );
                }
                
                // Category filter
                if (filters.category !== 'all') {
                    filtered = filtered.filter(t => t.category === filters.category);
                }
                
                // Type filter
                if (filters.type !== 'all') {
                    filtered = filtered.filter(t => t.type === filters.type);
                }
                
                // Account filter
                if (filters.account !== 'all') {
                    filtered = filtered.filter(t => t.account === filters.account);
                }
                
                // Date range filter
                if (filters.dateRange !== 'all') {
                    const now = new Date();
                    const filterDate = new Date(now);
                    
                    switch (filters.dateRange) {
                        case 'today':
                            filterDate.setDate(now.getDate());
                            break;
                        case 'week':
                            filterDate.setDate(now.getDate() - 7);
                            break;
                        case 'month':
                            filterDate.setMonth(now.getMonth() - 1);
                            break;
                        case 'quarter':
                            filterDate.setMonth(now.getMonth() - 3);
                            break;
                        case 'year':
                            filterDate.setFullYear(now.getFullYear() - 1);
                            break;
                    }
                    
                    filtered = filtered.filter(t => new Date(t.date) >= filterDate);
                }
                
                // Amount range filter
                if (filters.amountRange.min) {
                    filtered = filtered.filter(t => t.amount >= parseFloat(filters.amountRange.min));
                }
                if (filters.amountRange.max) {
                    filtered = filtered.filter(t => t.amount <= parseFloat(filters.amountRange.max));
                }
                
                // Sorting
                const sorted = [...filtered].sort((a, b) => {
                    let aValue, bValue;
                    
                    switch (sortBy) {
                        case 'date':
                            aValue = new Date(a.date);
                            bValue = new Date(b.date);
                            break;
                        case 'amount':
                            aValue = a.amount;
                            bValue = b.amount;
                            break;
                        case 'description':
                            aValue = a.description.toLowerCase();
                            bValue = b.description.toLowerCase();
                            break;
                        case 'category':
                            aValue = a.category.toLowerCase();
                            bValue = b.category.toLowerCase();
                            break;
                        default:
                            aValue = a[sortBy];
                            bValue = b[sortBy];
                    }
                    
                    if (aValue < bValue) return sortOrder === 'asc' ? -1 : 1;
                    if (aValue > bValue) return sortOrder === 'asc' ? 1 : -1;
                    return 0;
                });
                
                return sorted;
            }, [transactions, searchQuery, filters, sortBy, sortOrder]);
            
            // Financial calculations
            const financialMetrics = useMemo(() => {
                const totalAssets = accounts.reduce((sum, acc) => sum + acc.balance, 0);
                const totalDebt = debts.reduce((sum, debt) => sum + debt.balance, 0);
                const netWorth = totalAssets - totalDebt;
                
                const monthlyIncome = transactions
                    .filter(t => t.type === 'income' && new Date(t.date) > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000))
                    .reduce((sum, t) => sum + t.amount, 0);
                
                const monthlyExpenses = transactions
                    .filter(t => t.type === 'expense' && new Date(t.date) > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000))
                    .reduce((sum, t) => sum + t.amount, 0);
                
                const savingsRate = monthlyIncome > 0 ? ((monthlyIncome - monthlyExpenses) / monthlyIncome) * 100 : 0;
                
                const budgetUtilization = budgetEnvelopes.reduce((sum, env) => sum + (env.spent / env.budget), 0) / budgetEnvelopes.length * 100;
                
                const emergencyMonths = accounts.find(a => a.type === 'savings')?.balance / Math.max(monthlyExpenses, 1) || 0;
                
                return {
                    totalAssets,
                    totalDebt,
                    netWorth,
                    monthlyIncome,
                    monthlyExpenses,
                    savingsRate,
                    budgetUtilization,
                    emergencyMonths
                };
            }, [accounts, debts, transactions, budgetEnvelopes]);
            
            // Financial health scoring
            const financialHealth = useMemo(() => {
                const { netWorth, savingsRate, emergencyMonths, budgetUtilization } = financialMetrics;
                const debtToIncomeRatio = (debts.reduce((sum, d) => sum + d.balance, 0) / (financialMetrics.monthlyIncome * 12)) * 100;
                
                let score = 0;
                const factors = [];
                
                // Net Worth (25 points)
                if (netWorth >= 100000) {
                    score += 25;
                    factors.push({ name: 'Net Worth', score: 25, status: 'excellent', value: `$${netWorth.toLocaleString()}` });
                } else if (netWorth >= 50000) {
                    score += 20;
                    factors.push({ name: 'Net Worth', score: 20, status: 'good', value: `$${netWorth.toLocaleString()}` });
                } else if (netWorth >= 10000) {
                    score += 15;
                    factors.push({ name: 'Net Worth', score: 15, status: 'fair', value: `$${netWorth.toLocaleString()}` });
                } else {
                    score += 5;
                    factors.push({ name: 'Net Worth', score: 5, status: 'poor', value: `$${netWorth.toLocaleString()}` });
                }
                
                // Emergency Fund (25 points)
                if (emergencyMonths >= 6) {
                    score += 25;
                    factors.push({ name: 'Emergency Fund', score: 25, status: 'excellent', value: `${emergencyMonths.toFixed(1)} months` });
                } else if (emergencyMonths >= 3) {
                    score += 20;
                    factors.push({ name: 'Emergency Fund', score: 20, status: 'good', value: `${emergencyMonths.toFixed(1)} months` });
                } else if (emergencyMonths >= 1) {
                    score += 10;
                    factors.push({ name: 'Emergency Fund', score: 10, status: 'fair', value: `${emergencyMonths.toFixed(1)} months` });
                } else {
                    score += 0;
                    factors.push({ name: 'Emergency Fund', score: 0, status: 'poor', value: `${emergencyMonths.toFixed(1)} months` });
                }
                
                // Savings Rate (25 points)
                if (savingsRate >= 20) {
                    score += 25;
                    factors.push({ name: 'Savings Rate', score: 25, status: 'excellent', value: `${savingsRate.toFixed(1)}%` });
                } else if (savingsRate >= 10) {
                    score += 20;
                    factors.push({ name: 'Savings Rate', score: 20, status: 'good', value: `${savingsRate.toFixed(1)}%` });
                } else if (savingsRate >= 5) {
                    score += 10;
                    factors.push({ name: 'Savings Rate', score: 10, status: 'fair', value: `${savingsRate.toFixed(1)}%` });
                } else {
                    score += 0;
                    factors.push({ name: 'Savings Rate', score: 0, status: 'poor', value: `${savingsRate.toFixed(1)}%` });
                }
                
                // Debt Management (25 points)
                if (debtToIncomeRatio <= 10) {
                    score += 25;
                    factors.push({ name: 'Debt Management', score: 25, status: 'excellent', value: `${debtToIncomeRatio.toFixed(1)}% DTI` });
                } else if (debtToIncomeRatio <= 20) {
                    score += 20;
                    factors.push({ name: 'Debt Management', score: 20, status: 'good', value: `${debtToIncomeRatio.toFixed(1)}% DTI` });
                } else if (debtToIncomeRatio <= 35) {
                    score += 10;
                    factors.push({ name: 'Debt Management', score: 10, status: 'fair', value: `${debtToIncomeRatio.toFixed(1)}% DTI` });
                } else {
                    score += 0;
                    factors.push({ name: 'Debt Management', score: 0, status: 'poor', value: `${debtToIncomeRatio.toFixed(1)}% DTI` });
                }
                
                const grade = score >= 90 ? 'A+' : score >= 85 ? 'A' : score >= 80 ? 'A-' : 
                             score >= 75 ? 'B+' : score >= 70 ? 'B' : score >= 65 ? 'B-' :
                             score >= 60 ? 'C+' : score >= 55 ? 'C' : score >= 50 ? 'C-' :
                             score >= 45 ? 'D+' : score >= 40 ? 'D' : 'F';
                
                return { score: Math.round(score), factors, grade };
            }, [financialMetrics, debts]);
            
            // Chart data preparation
            const chartData = useMemo(() => {
                const monthlySpending = {
                    labels: budgetEnvelopes.map(e => e.category),
                    datasets: [{
                        label: 'Budget',
                        data: budgetEnvelopes.map(e => e.budget),
                        backgroundColor: budgetEnvelopes.map(e => e.color + '40'),
                        borderColor: budgetEnvelopes.map(e => e.color),
                        borderWidth: 2,
                        borderRadius: 8
                    }, {
                        label: 'Spent',
                        data: budgetEnvelopes.map(e => e.spent),
                        backgroundColor: budgetEnvelopes.map(e => e.color + '80'),
                        borderColor: budgetEnvelopes.map(e => e.color),
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                };
                
                const portfolioPie = {
                    labels: investmentPortfolio.map(a => a.asset),
                    datasets: [{
                        data: investmentPortfolio.map(a => a.value),
                        backgroundColor: [
                            'rgba(0, 255, 255, 0.8)',
                            'rgba(120, 255, 214, 0.8)',
                            'rgba(255, 0, 128, 0.8)',
                            'rgba(255, 215, 0, 0.8)',
                            'rgba(139, 92, 246, 0.8)'
                        ],
                        borderWidth: 3,
                        borderColor: '#0a0a0a',
                        hoverBorderWidth: 4
                    }]
                };
                
                // Enhanced spending trends
                const last30Days = [...Array(30)].map((_, i) => {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    return date.toISOString().split('T')[0];
                }).reverse();
                
                const spendingTrends = {
                    labels: last30Days.map(date => new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })),
                    datasets: [{
                        label: 'Daily Spending',
                        data: last30Days.map(date => {
                            return transactions
                                .filter(t => t.type === 'expense' && t.date === date)
                                .reduce((sum, t) => sum + t.amount, 0);
                        }),
                        borderColor: 'rgba(0, 255, 255, 1)',
                        backgroundColor: 'rgba(0, 255, 255, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: 'rgba(0, 255, 255, 1)',
                        pointBorderColor: '#0a0a0a',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                };
                
                return { monthlySpending, portfolioPie, spendingTrends };
            }, [budgetEnvelopes, investmentPortfolio, transactions]);
            
            // Export functionality
            const exportData = useCallback(async (format = 'xlsx') => {
                setLoading(true);
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 1500)); // Simulate processing
                    
                    if (format === 'xlsx' && window.XLSX) {
                        const wb = XLSX.utils.book_new();
                        
                        // Summary sheet
                        const summary = [
                            { Metric: 'Net Worth', Value: financialMetrics.netWorth },
                            { Metric: 'Total Assets', Value: financialMetrics.totalAssets },
                            { Metric: 'Total Debt', Value: financialMetrics.totalDebt },
                            { Metric: 'Monthly Income', Value: financialMetrics.monthlyIncome },
                            { Metric: 'Monthly Expenses', Value: financialMetrics.monthlyExpenses },
                            { Metric: 'Savings Rate (%)', Value: financialMetrics.savingsRate },
                            { Metric: 'Financial Health Score', Value: financialHealth.score },
                            { Metric: 'Financial Health Grade', Value: financialHealth.grade }
                        ];
                        XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(summary), "Financial Summary");
                        
                        // Transactions sheet
                        XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(transactions), "Transactions");
                        
                        // Accounts sheet
                        XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(accounts), "Accounts");
                        
                        // Budget sheet
                        XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(budgetEnvelopes), "Budget");
                        
                        // Portfolio sheet
                        XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(investmentPortfolio), "Portfolio");
                        
                        // Debts sheet
                        XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(debts), "Debts");
                        
                        const filename = `FinancialReport_${new Date().toISOString().split('T')[0]}.xlsx`;
                        XLSX.writeFile(wb, filename);
                        
                        addNotification(
                            `Financial report exported successfully as ${filename}`,
                            'success',
                            'Export Complete'
                        );
                    } else {
                        // Fallback: Generate CSV with better error handling
                        try {
                            const csvData = transactions.map(t => ({
                                Date: t.date,
                                Description: t.description,
                                Amount: t.amount,
                                Category: t.category,
                                Type: t.type,
                                Account: t.account
                            }));
                            
                            const csvContent = Papa.unparse(csvData);
                            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                            
                            // Use modern download approach
                            if (window.navigator && window.navigator.msSaveOrOpenBlob) {
                                // IE fallback
                                window.navigator.msSaveOrOpenBlob(blob, `transactions_${new Date().toISOString().split('T')[0]}.csv`);
                            } else {
                                // Modern browsers
                                const url = URL.createObjectURL(blob);
                                const link = document.createElement('a');
                                link.href = url;
                                link.download = `transactions_${new Date().toISOString().split('T')[0]}.csv`;
                                link.style.display = 'none';
                                
                                // Safely append, click, and remove
                                try {
                                    document.body.appendChild(link);
                                    link.click();
                                    
                                    // Clean up with timeout to ensure click completes
                                    setTimeout(() => {
                                        try {
                                            if (link.parentNode) {
                                                document.body.removeChild(link);
                                            }
                                            URL.revokeObjectURL(url);
                                        } catch (cleanupError) {
                                            console.warn('Cleanup error:', cleanupError);
                                        }
                                    }, 100);
                                } catch (appendError) {
                                    console.error('Failed to trigger download:', appendError);
                                    // Fallback to opening in new window
                                    window.open(url, '_blank');
                                }
                            }
                        } catch (csvError) {
                            console.error('CSV generation error:', csvError);
                            throw new Error('Failed to generate CSV file');
                        }
                        
                        addNotification(
                            'Transaction data exported as CSV',
                            'success',
                            'Export Complete'
                        );
                    }
                } catch (error) {
                    addNotification(
                        'Failed to export data. Please try again.',
                        'error',
                        'Export Failed'
                    );
                } finally {
                    setLoading(false);
                }
            }, [transactions, accounts, budgetEnvelopes, investmentPortfolio, debts, financialMetrics, financialHealth, addNotification]);
            
            // File import handling
            const handleFileUpload = useCallback((event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                // Validate file
                const maxSize = 10 * 1024 * 1024; // 10MB
                if (file.size > maxSize) {
                    addNotification(
                        'File size exceeds 10MB limit',
                        'error',
                        'File Too Large'
                    );
                    return;
                }
                
                const allowedTypes = ['text/csv', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'];
                if (!allowedTypes.includes(file.type)) {
                    addNotification(
                        'Please upload a CSV or Excel file',
                        'error',
                        'Invalid File Type'
                    );
                    return;
                }
                
                setLoading(true);
                
                if (file.type === 'text/csv') {
                    Papa.parse(file, {
                        header: true,
                        dynamicTyping: true,
                        skipEmptyLines: true,
                        complete: (results) => {
                            try {
                                if (results.errors.length > 0) {
                                    console.warn('CSV parsing warnings:', results.errors);
                                }
                                
                                const processedTransactions = results.data
                                    .filter(row => row.Amount || row.amount || row.Debit || row.Credit)
                                    .map((row, index) => {
                                        const amount = Math.abs(parseFloat(
                                            row.Amount || row.amount || row.Debit || row.Credit || 0
                                        ));
                                        const description = (
                                            row.Description || row.description || 
                                            row.Merchant || row.merchant || 
                                            row.Payee || row.payee || 
                                            'Imported Transaction'
                                        ).trim();
                                        const date = row.Date || row.date || new Date().toISOString().split('T')[0];
                                        
                                        // Simple categorization
                                        const category = row.Category || row.category || 'Other';
                                        const isDebit = row.Debit || (row.Amount && row.Amount < 0) || 
                                                       (row.Type && row.Type.toLowerCase().includes('debit'));
                                        
                                        return {
                                            id: `imported_${Date.now()}_${index}`,
                                            date,
                                            description,
                                            amount,
                                            category,
                                            confidence: 85,
                                            type: isDebit ? 'expense' : 'income',
                                            account: row.Account || 'Checking',
                                            notes: `Imported from ${file.name}`,
                                            tags: ['imported'],
                                            recurring: false,
                                            createdAt: new Date().toISOString(),
                                            updatedAt: new Date().toISOString()
                                        };
                                    });
                                
                                if (processedTransactions.length === 0) {
                                    addNotification(
                                        'No valid transactions found in the file',
                                        'warning',
                                        'Import Warning'
                                    );
                                } else {
                                    setTransactions(prev => [...processedTransactions, ...prev]);
                                    addNotification(
                                        `Successfully imported ${processedTransactions.length} transactions`,
                                        'success',
                                        'Import Complete'
                                    );
                                }
                            } catch (error) {
                                console.error('Error processing transactions:', error);
                                addNotification(
                                    'Error processing CSV file. Please check the format and try again.',
                                    'error',
                                    'Import Error'
                                );
                            } finally {
                                setLoading(false);
                            }
                        },
                        error: (error) => {
                            console.error('CSV parsing error:', error);
                            addNotification(
                                'Error reading CSV file. Please check the file format.',
                                'error',
                                'File Read Error'
                            );
                            setLoading(false);
                        }
                    });
                } else {
                    // Handle Excel files if needed
                    addNotification(
                        'Excel import feature coming soon. Please use CSV format.',
                        'info',
                        'Feature Coming Soon'
                    );
                    setLoading(false);
                }
                
                // Reset file input safely
                if (event.target) {
                    try {
                        event.target.value = '';
                    } catch (resetError) {
                        console.warn('Failed to reset file input:', resetError);
                    }
                }
            }, [addNotification]);
            
            // Tab definitions
            const tabs = [
                { id: 'dashboard', label: 'Dashboard', icon: 'layout-dashboard', description: 'Overview & Summary' },
                { id: 'transactions', label: 'Transactions', icon: 'receipt', description: 'Transaction History' },
                { id: 'accounts', label: 'Accounts', icon: 'wallet', description: 'Account Management' },
                { id: 'budget', label: 'Budget', icon: 'calculator', description: 'Budget Planning' },
                { id: 'investments', label: 'Investments', icon: 'trending-up', description: 'Portfolio Analysis' },
                { id: 'debt', label: 'Debt', icon: 'credit-card', description: 'Debt Management' },
                { id: 'reports', label: 'Reports', icon: 'bar-chart-3', description: 'Financial Reports' },
                { id: 'goals', label: 'Goals', icon: 'target', description: 'Financial Goals' },
                { id: 'analytics', label: 'Analytics', icon: 'pie-chart', description: 'Advanced Analytics' }
            ];
            
            // Initialize icons with better error handling
            useEffect(() => {
                try {
                    if (window.lucide) {
                        requestAnimationFrame(() => {
                            try {
                                lucide.createIcons();
                            } catch (iconError) {
                                console.warn('Icon initialization error:', iconError);
                            }
                        });
                    }
                } catch (error) {
                    console.warn('Failed to initialize icons:', error);
                }
            }, [activeTab]);
            
            // Keyboard shortcuts with error handling
            useEffect(() => {
                const handleKeyboard = (e) => {
                    try {
                        if (e.ctrlKey || e.metaKey) {
                            switch (e.key) {
                                case 'n':
                                    e.preventDefault();
                                    setShowTransactionForm(true);
                                    break;
                                case 'e':
                                    e.preventDefault();
                                    exportData();
                                    break;
                                case 'f':
                                    e.preventDefault();
                                    setShowFilters(!showFilters);
                                    break;
                            }
                        }
                        
                        if (e.key === 'Escape') {
                            setShowTransactionForm(false);
                            setShowFilters(false);
                        }
                    } catch (keyboardError) {
                        console.warn('Keyboard shortcut error:', keyboardError);
                    }
                };
                
                try {
                    document.addEventListener('keydown', handleKeyboard);
                    return () => {
                        try {
                            document.removeEventListener('keydown', handleKeyboard);
                        } catch (removeError) {
                            console.warn('Failed to remove keyboard listener:', removeError);
                        }
                    };
                } catch (addError) {
                    console.warn('Failed to add keyboard listener:', addError);
                }
            }, [showFilters, exportData]);
            
            return (
                <div className="min-h-screen p-4 transition-all duration-700 gpu-accelerated">
                    {/* Data flow animation */}
                    {[...Array(3)].map((_, i) => (
                        <div 
                            key={i} 
                            className="data-flow"
                            style={{ 
                                top: `${20 + i * 30}%`,
                                animationDelay: `${i * 1.5}s`
                            }}
                        />
                    ))}
                    
                    {/* Notification System */}
                    <NotificationSystem 
                        notifications={notifications} 
                        onRemove={removeNotification}
                    />
                    
                    {/* Loading Overlay */}
                    {loading && (
                        <div className="fixed inset-0 bg-black/90 backdrop-blur-lg flex items-center justify-center z-50">
                            <div className="text-center">
                                <LoadingSpinner size="lg" text="Processing your financial data..." />
                                <p className="text-gray-400 mt-4 text-sm">
                                    Please wait while we secure your information
                                </p>
                            </div>
                        </div>
                    )}
                    
                    <div className="max-w-7xl mx-auto">
                        {/* Enhanced Header */}
                        <div className="glass-premium rounded-3xl p-8 mb-8 animate-slide-up">
                            <div className="flex justify-between items-center flex-wrap gap-6">
                                <div className="flex-1">
                                    <h1 className="text-4xl font-bold mb-3 text-gradient">
                                        Personal Finance Command Center
                                    </h1>
                                    <p className="text-gray-400 text-lg font-medium">
                                        Professional Financial Management & Analytics Platform
                                    </p>
                                    <div className="flex items-center gap-4 mt-3 text-sm text-gray-500">
                                        <span className="flex items-center gap-1">
                                            <Icon name="shield-check" size={14} />
                                            Bank-level Security
                                        </span>
                                        <span className="flex items-center gap-1">
                                            <Icon name="activity" size={14} />
                                            Real-time Analytics
                                        </span>
                                        <span className="flex items-center gap-1">
                                            <Icon name="zap" size={14} />
                                            AI-Powered Insights
                                        </span>
                                    </div>
                                </div>
                                
                                <div className="flex gap-4 items-center">
                                    <div className="text-right">
                                        <div className="text-sm text-gray-400">Last Updated</div>
                                        <div className="font-mono text-cyan-400">
                                            {new Date().toLocaleString()}
                                        </div>
                                    </div>
                                    
                                    <div className="hidden md:flex gap-3">
                                        <label className="btn btn-outline px-6 py-3 rounded-xl cursor-pointer">
                                            <Icon name="upload" size={18} className="mr-2" />
                                            Import Data
                                            <input 
                                                type="file" 
                                                accept=".csv,.xlsx" 
                                                onChange={handleFileUpload} 
                                                className="hidden" 
                                            />
                                        </label>
                                        
                                        <button
                                            onClick={() => exportData('xlsx')}
                                            className="btn btn-primary px-6 py-3 rounded-xl"
                                        >
                                            <Icon name="download" size={18} className="mr-2" />
                                            Export Report
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        {/* Enhanced Financial Health Dashboard */}
                        <div className="glass rounded-3xl p-8 mb-8 animate-slide-up">
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8 items-center">
                                <div className="lg:col-span-2">
                                    <h3 className="text-xl font-semibold text-gray-300 mb-4">Financial Health Assessment</h3>
                                    <div className="flex items-center gap-8 mb-6">
                                        <div className="relative">
                                            <div className="text-6xl font-bold text-gradient">
                                                {financialHealth.score}
                                            </div>
                                            <div className="absolute -top-2 -right-2">
                                                <div className={`text-2xl font-bold px-3 py-1 rounded-lg ${
                                                    financialHealth.score >= 85 ? 'bg-gradient-to-r from-green-500/20 to-emerald-500/20 text-green-400 border border-green-500/50' :
                                                    financialHealth.score >= 70 ? 'bg-gradient-to-r from-blue-500/20 to-cyan-500/20 text-blue-400 border border-blue-500/50' :
                                                    financialHealth.score >= 55 ? 'bg-gradient-to-r from-yellow-500/20 to-amber-500/20 text-yellow-400 border border-yellow-500/50' :
                                                    'bg-gradient-to-r from-red-500/20 to-pink-500/20 text-red-400 border border-red-500/50'
                                                }`}>
                                                    {financialHealth.grade}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div className="flex-1">
                                            <div className="grid grid-cols-2 gap-4">
                                                <div>
                                                    <div className="text-sm text-gray-400">Net Worth</div>
                                                    <div className="text-xl font-bold text-white">
                                                        ${financialMetrics.netWorth.toLocaleString()}
                                                    </div>
                                                </div>
                                                <div>
                                                    <div className="text-sm text-gray-400">Savings Rate</div>
                                                    <div className="text-xl font-bold text-green-400">
                                                        {financialMetrics.savingsRate.toFixed(1)}%
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className="space-y-3">
                                        {financialHealth.factors.map(factor => (
                                            <div key={factor.name} className="flex items-center gap-4">
                                                <span className="text-sm font-medium text-gray-300 w-32">
                                                    {factor.name}
                                                </span>
                                                <div className="flex-1 progress-bar">
                                                    <div 
                                                        className={`progress-fill ${
                                                            factor.status === 'excellent' ? '' :
                                                            factor.status === 'good' ? '' :
                                                            factor.status === 'fair' ? 'warning' : 'danger'
                                                        }`}
                                                        style={{ width: `${(factor.score / 25) * 100}%` }}
                                                    />
                                                </div>
                                                <span className="text-sm font-medium text-gray-400 w-24 text-right">
                                                    {factor.value}
                                                </span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                
                                <div className="text-center">
                                    <div className="glass-dark rounded-2xl p-6">
                                        <h4 className="text-lg font-semibold text-white mb-4">Quick Actions</h4>
                                        <div className="space-y-3">
                                            <button 
                                                onClick={() => setShowTransactionForm(true)}
                                                className="w-full btn btn-primary py-3 rounded-xl text-sm"
                                            >
                                                <Icon name="plus-circle" size={16} className="mr-2" />
                                                Add Transaction
                                            </button>
                                            <button 
                                                onClick={() => setActiveTab('budget')}
                                                className="w-full btn btn-outline py-3 rounded-xl text-sm"
                                            >
                                                <Icon name="calculator" size={16} className="mr-2" />
                                                Review Budget
                                            </button>
                                            <button 
                                                onClick={() => setActiveTab('investments')}
                                                className="w-full btn btn-ghost py-3 rounded-xl text-sm"
                                            >
                                                <Icon name="trending-up" size={16} className="mr-2" />
                                                Check Portfolio
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        {/* Enhanced Tab Navigation */}
                        <div className="glass rounded-3xl p-3 mb-8 animate-slide-up">
                            <div className="flex gap-2 overflow-x-auto scrollbar-thin">
                                {tabs.map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`px-6 py-4 rounded-2xl font-medium transition-all flex items-center gap-3 whitespace-nowrap group ${
                                            activeTab === tab.id
                                                ? 'tab-active text-white'
                                                : 'tab-inactive hover:text-white'
                                        }`}
                                    >
                                        <Icon name={tab.icon} size={20} />
                                        <div className="text-left">
                                            <div className="font-semibold">{tab.label}</div>
                                            <div className="text-xs opacity-75">{tab.description}</div>
                                        </div>
                                    </button>
                                ))}
                            </div>
                        </div>
                        
                        {/* Enhanced Content Area */}
                        <div className="glass-premium rounded-3xl p-8 min-h-[700px] animate-slide-up">
                            {/* Dashboard Content */}
                            {activeTab === 'dashboard' && (
                                <div className="space-y-8">
                                    {/* Key Metrics Grid */}
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                        {[
                                            {
                                                title: 'Net Worth',
                                                value: financialMetrics.netWorth,
                                                format: 'currency',
                                                change: '+5.2%',
                                                positive: true,
                                                icon: 'trending-up',
                                                color: 'cyan'
                                            },
                                            {
                                                title: 'Total Assets',
                                                value: financialMetrics.totalAssets,
                                                format: 'currency',
                                                change: '+2.8%',
                                                positive: true,
                                                icon: 'wallet',
                                                color: 'green'
                                            },
                                            {
                                                title: 'Monthly Income',
                                                value: financialMetrics.monthlyIncome,
                                                format: 'currency',
                                                change: '+1.2%',
                                                positive: true,
                                                icon: 'arrow-up-circle',
                                                color: 'blue'
                                            },
                                            {
                                                title: 'Monthly Expenses',
                                                value: financialMetrics.monthlyExpenses,
                                                format: 'currency',
                                                change: '-3.1%',
                                                positive: true,
                                                icon: 'arrow-down-circle',
                                                color: 'pink'
                                            }
                                        ].map((metric, index) => (
                                            <div key={metric.title} className="glass-dark rounded-2xl p-6 card-hover">
                                                <div className="flex items-center justify-between mb-4">
                                                    <Icon 
                                                        name={metric.icon} 
                                                        size={24} 
                                                        className={`text-${metric.color}-400`} 
                                                    />
                                                    <span className={`text-sm font-medium ${
                                                        metric.positive ? 'text-green-400' : 'text-red-400'
                                                    }`}>
                                                        {metric.change}
                                                    </span>
                                                </div>
                                                <h3 className="text-gray-400 text-sm font-medium mb-2">
                                                    {metric.title}
                                                </h3>
                                                <p className="text-2xl font-bold text-white mb-1">
                                                    {metric.format === 'currency' 
                                                        ? `$${metric.value.toLocaleString()}` 
                                                        : metric.value.toLocaleString()
                                                    }
                                                </p>
                                                <p className="text-xs text-gray-500">vs last month</p>
                                            </div>
                                        ))}
                                    </div>
                                    
                                    {/* Enhanced Charts Section */}
                                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                        <div className="glass-dark rounded-2xl p-6">
                                            <div className="flex items-center justify-between mb-6">
                                                <h3 className="text-xl font-semibold text-white">Budget Overview</h3>
                                                <button 
                                                    onClick={() => setActiveTab('budget')}
                                                    className="btn btn-ghost px-4 py-2 rounded-lg text-sm"
                                                >
                                                    <Icon name="external-link" size={14} className="mr-1" />
                                                    View Details
                                                </button>
                                            </div>
                                            <ChartComponent
                                                type="bar"
                                                data={chartData.monthlySpending}
                                                options={{
                                                    plugins: {
                                                        legend: { 
                                                            labels: { color: '#ffffff', font: { size: 12 } },
                                                            position: 'top'
                                                        },
                                                        tooltip: {
                                                            callbacks: {
                                                                label: function(context) {
                                                                    return `${context.dataset.label}: $${context.parsed.y.toLocaleString()}`;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }}
                                                id="budget-overview-chart"
                                            />
                                        </div>
                                        
                                        <div className="glass-dark rounded-2xl p-6">
                                            <div className="flex items-center justify-between mb-6">
                                                <h3 className="text-xl font-semibold text-white">Portfolio Allocation</h3>
                                                <button 
                                                    onClick={() => setActiveTab('investments')}
                                                    className="btn btn-ghost px-4 py-2 rounded-lg text-sm"
                                                >
                                                    <Icon name="external-link" size={14} className="mr-1" />
                                                    Manage Portfolio
                                                </button>
                                            </div>
                                            <ChartComponent
                                                type="doughnut"
                                                data={chartData.portfolioPie}
                                                options={{
                                                    plugins: {
                                                        legend: { 
                                                            labels: { color: '#ffffff', font: { size: 11 } },
                                                            position: 'bottom'
                                                        }
                                                    }
                                                }}
                                                id="portfolio-allocation-chart"
                                            />
                                        </div>
                                    </div>
                                    
                                    {/* Spending Trends */}
                                    <div className="glass-dark rounded-2xl p-6">
                                        <div className="flex items-center justify-between mb-6">
                                            <h3 className="text-xl font-semibold text-white">Spending Trends (Last 30 Days)</h3>
                                            <div className="flex gap-2">
                                                <button className="btn btn-ghost px-4 py-2 rounded-lg text-sm">
                                                    7D
                                                </button>
                                                <button className="btn btn-outline px-4 py-2 rounded-lg text-sm">
                                                    30D
                                                </button>
                                                <button className="btn btn-ghost px-4 py-2 rounded-lg text-sm">
                                                    90D
                                                </button>
                                            </div>
                                        </div>
                                        <ChartComponent
                                            type="line"
                                            data={chartData.spendingTrends}
                                            options={{
                                                plugins: {
                                                    legend: { display: false }
                                                },
                                                scales: {
                                                    y: {
                                                        beginAtZero: true,
                                                        ticks: {
                                                            callback: function(value) {
                                                                return '$' + value.toLocaleString();
                                                            }
                                                        }
                                                    }
                                                }
                                            }}
                                            id="spending-trends-chart"
                                        />
                                    </div>
                                    
                                    {/* Quick Insights */}
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                        <div className="glass-dark rounded-2xl p-6">
                                            <div className="flex items-center gap-3 mb-4">
                                                <Icon name="target" size={24} className="text-green-400" />
                                                <h4 className="font-semibold text-white">Top Performer</h4>
                                            </div>
                                            <p className="text-gray-300 mb-2">
                                                You're <span className="text-green-400 font-semibold">saving 15% more</span> than your target this month!
                                            </p>
                                            <button className="text-cyan-400 text-sm hover:text-cyan-300 transition-colors">
                                                View savings goals 
                                            </button>
                                        </div>
                                        
                                        <div className="glass-dark rounded-2xl p-6">
                                            <div className="flex items-center gap-3 mb-4">
                                                <Icon name="alert-triangle" size={24} className="text-yellow-400" />
                                                <h4 className="font-semibold text-white">Budget Alert</h4>
                                            </div>
                                            <p className="text-gray-300 mb-2">
                                                You're close to your <span className="text-yellow-400 font-semibold">Entertainment</span> budget limit.
                                            </p>
                                            <button className="text-cyan-400 text-sm hover:text-cyan-300 transition-colors">
                                                Adjust budget 
                                            </button>
                                        </div>
                                        
                                        <div className="glass-dark rounded-2xl p-6">
                                            <div className="flex items-center gap-3 mb-4">
                                                <Icon name="trending-up" size={24} className="text-blue-400" />
                                                <h4 className="font-semibold text-white">Investment Tip</h4>
                                            </div>
                                            <p className="text-gray-300 mb-2">
                                                Consider <span className="text-blue-400 font-semibold">rebalancing</span> your portfolio this quarter.
                                            </p>
                                            <button className="text-cyan-400 text-sm hover:text-cyan-300 transition-colors">
                                                Learn more 
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {/* Transactions Content */}
                            {activeTab === 'transactions' && (
                                <div className="space-y-6">
                                    {/* Enhanced Transaction Header */}
                                    <div className="flex flex-col lg:flex-row lg:items-center gap-4 justify-between">
                                        <div>
                                            <h2 className="text-2xl font-bold text-white mb-2">Transaction History</h2>
                                            <p className="text-gray-400">
                                                Manage and analyze your financial transactions
                                            </p>
                                        </div>
                                        
                                        <div className="flex gap-3">
                                            <button 
                                                onClick={() => setShowFilters(!showFilters)}
                                                className={`btn px-4 py-3 rounded-xl ${showFilters ? 'btn-primary' : 'btn-outline'}`}
                                            >
                                                <Icon name="filter" size={16} className="mr-2" />
                                                Filters
                                            </button>
                                            <button 
                                                onClick={() => setShowTransactionForm(true)}
                                                className="btn btn-primary px-6 py-3 rounded-xl"
                                            >
                                                <Icon name="plus-circle" size={16} className="mr-2" />
                                                Add Transaction
                                            </button>
                                        </div>
                                    </div>
                                    
                                    {/* Search and Quick Filters */}
                                    <div className="flex flex-col lg:flex-row gap-4">
                                        <div className="flex-1 relative">
                                            <Icon name="search" size={20} className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500" />
                                            <input
                                                type="text"
                                                placeholder="Search transactions, categories, or notes..."
                                                value={searchQuery}
                                                onChange={(e) => setSearchQuery(e.target.value)}
                                                className="w-full pl-12 pr-4 py-3"
                                            />
                                        </div>
                                        
                                        <div className="flex gap-3">
                                            <select
                                                value={sortBy}
                                                onChange={(e) => setSortBy(e.target.value)}
                                                className="px-4 py-3"
                                            >
                                                <option value="date">Sort by Date</option>
                                                <option value="amount">Sort by Amount</option>
                                                <option value="category">Sort by Category</option>
                                                <option value="description">Sort by Description</option>
                                            </select>
                                            
                                            <button
                                                onClick={() => setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc')}
                                                className="btn btn-ghost px-4 py-3 rounded-xl"
                                            >
                                                <Icon name={sortOrder === 'asc' ? 'arrow-up' : 'arrow-down'} size={16} />
                                            </button>
                                        </div>
                                    </div>
                                    
                                    {/* Enhanced Filter Panel */}
                                    {showFilters && (
                                        <div className="glass-dark rounded-2xl p-6 animate-slide-up">
                                            <h3 className="font-semibold text-white mb-4">Advanced Filters</h3>
                                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                                <FormField label="Category">
                                                    <select
                                                        value={filters.category}
                                                        onChange={(e) => setFilters({...filters, category: e.target.value})}
                                                        className="w-full"
                                                    >
                                                        <option value="all">All Categories</option>
                                                        {[...new Set(transactions.map(t => t.category))].map(cat => (
                                                            <option key={cat} value={cat}>{cat}</option>
                                                        ))}
                                                    </select>
                                                </FormField>
                                                
                                                <FormField label="Transaction Type">
                                                    <select
                                                        value={filters.type}
                                                        onChange={(e) => setFilters({...filters, type: e.target.value})}
                                                        className="w-full"
                                                    >
                                                        <option value="all">All Types</option>
                                                        <option value="income">Income</option>
                                                        <option value="expense">Expense</option>
                                                    </select>
                                                </FormField>
                                                
                                                <FormField label="Account">
                                                    <select
                                                        value={filters.account}
                                                        onChange={(e) => setFilters({...filters, account: e.target.value})}
                                                        className="w-full"
                                                    >
                                                        <option value="all">All Accounts</option>
                                                        {[...new Set(transactions.map(t => t.account))].map(acc => (
                                                            <option key={acc} value={acc}>{acc}</option>
                                                        ))}
                                                    </select>
                                                </FormField>
                                                
                                                <FormField label="Date Range">
                                                    <select
                                                        value={filters.dateRange}
                                                        onChange={(e) => setFilters({...filters, dateRange: e.target.value})}
                                                        className="w-full"
                                                    >
                                                        <option value="all">All Time</option>
                                                        <option value="today">Today</option>
                                                        <option value="week">Last Week</option>
                                                        <option value="month">Last Month</option>
                                                        <option value="quarter">Last Quarter</option>
                                                        <option value="year">Last Year</option>
                                                    </select>
                                                </FormField>
                                            </div>
                                            
                                            <div className="flex gap-3 mt-4">
                                                <button
                                                    onClick={() => setFilters({
                                                        category: 'all',
                                                        type: 'all',
                                                        dateRange: 'all',
                                                        amountRange: { min: '', max: '' },
                                                        account: 'all'
                                                    })}
                                                    className="btn btn-outline px-4 py-2 rounded-lg"
                                                >
                                                    Clear Filters
                                                </button>
                                                <button
                                                    onClick={() => setShowFilters(false)}
                                                    className="btn btn-ghost px-4 py-2 rounded-lg"
                                                >
                                                    Hide Filters
                                                </button>
                                            </div>
                                        </div>
                                    )}
                                    
                                    {/* Transaction Summary Stats */}
                                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div className="glass-dark rounded-xl p-4 text-center">
                                            <div className="text-2xl font-bold text-white">
                                                {filteredAndSortedTransactions.length}
                                            </div>
                                            <div className="text-sm text-gray-400">Total Transactions</div>
                                        </div>
                                        <div className="glass-dark rounded-xl p-4 text-center">
                                            <div className="text-2xl font-bold text-green-400">
                                                ${filteredAndSortedTransactions
                                                    .filter(t => t.type === 'income')
                                                    .reduce((sum, t) => sum + t.amount, 0)
                                                    .toLocaleString()}
                                            </div>
                                            <div className="text-sm text-gray-400">Total Income</div>
                                        </div>
                                        <div className="glass-dark rounded-xl p-4 text-center">
                                            <div className="text-2xl font-bold text-red-400">
                                                ${filteredAndSortedTransactions
                                                    .filter(t => t.type === 'expense')
                                                    .reduce((sum, t) => sum + t.amount, 0)
                                                    .toLocaleString()}
                                            </div>
                                            <div className="text-sm text-gray-400">Total Expenses</div>
                                        </div>
                                        <div className="glass-dark rounded-xl p-4 text-center">
                                            <div className="text-2xl font-bold text-cyan-400">
                                                ${(filteredAndSortedTransactions
                                                    .filter(t => t.type === 'income')
                                                    .reduce((sum, t) => sum + t.amount, 0) -
                                                  filteredAndSortedTransactions
                                                    .filter(t => t.type === 'expense')
                                                    .reduce((sum, t) => sum + t.amount, 0)
                                                ).toLocaleString()}
                                            </div>
                                            <div className="text-sm text-gray-400">Net Amount</div>
                                        </div>
                                    </div>
                                    
                                    {/* Enhanced Transaction Table */}
                                    {filteredAndSortedTransactions.length === 0 ? (
                                        <div className="glass-dark rounded-2xl p-12 text-center">
                                            <Icon name="receipt" size={64} className="text-gray-600 mx-auto mb-6" />
                                            <h3 className="text-xl font-semibold text-white mb-3">
                                                {searchQuery || Object.values(filters).some(f => f !== 'all' && f !== '') 
                                                    ? 'No transactions match your criteria'
                                                    : 'No transactions yet'
                                                }
                                            </h3>
                                            <p className="text-gray-400 mb-6">
                                                {searchQuery || Object.values(filters).some(f => f !== 'all' && f !== '')
                                                    ? 'Try adjusting your search or filters'
                                                    : 'Start by adding your first transaction or importing data from your bank'
                                                }
                                            </p>
                                            <div className="flex gap-3 justify-center">
                                                <button 
                                                    onClick={() => setShowTransactionForm(true)}
                                                    className="btn btn-primary px-6 py-3 rounded-xl"
                                                >
                                                    <Icon name="plus-circle" size={16} className="mr-2" />
                                                    Add Transaction
                                                </button>
                                                <label className="btn btn-outline px-6 py-3 rounded-xl cursor-pointer">
                                                    <Icon name="upload" size={16} className="mr-2" />
                                                    Import CSV
                                                    <input 
                                                        type="file" 
                                                        accept=".csv" 
                                                        onChange={handleFileUpload} 
                                                        className="hidden" 
                                                    />
                                                </label>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="table-container">
                                            <table>
                                                <thead>
                                                    <tr>
                                                        <th className="text-left">Date</th>
                                                        <th className="text-left">Description</th>
                                                        <th className="text-left">Category</th>
                                                        <th className="text-left">Account</th>
                                                        <th className="text-right">Amount</th>
                                                        <th className="text-center">Status</th>
                                                        <th className="text-center">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {filteredAndSortedTransactions.slice(0, 50).map(transaction => (
                                                        <tr key={transaction.id}>
                                                            <td className="font-mono text-sm">
                                                                {new Date(transaction.date).toLocaleDateString()}
                                                            </td>
                                                            <td>
                                                                <div>
                                                                    <div className="font-medium text-white">
                                                                        {transaction.description}
                                                                    </div>
                                                                    {transaction.notes && (
                                                                        <div className="text-xs text-gray-500 mt-1">
                                                                            {transaction.notes}
                                                                        </div>
                                                                    )}
                                                                    {transaction.tags.length > 0 && (
                                                                        <div className="flex gap-1 mt-1">
                                                                            {transaction.tags.slice(0, 2).map(tag => (
                                                                                <span 
                                                                                    key={tag}
                                                                                    className="px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs"
                                                                                >
                                                                                    {tag}
                                                                                </span>
                                                                            ))}
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <span className="px-3 py-1 bg-cyan-500/20 text-cyan-300 rounded-full text-xs font-medium border border-cyan-500/30">
                                                                    {transaction.category}
                                                                </span>
                                                            </td>
                                                            <td>
                                                                <span className="text-sm text-gray-400">
                                                                    {transaction.account}
                                                                </span>
                                                            </td>
                                                            <td className="text-right">
                                                                <span className={`font-bold text-lg ${
                                                                    transaction.type === 'expense' ? 'text-red-400' : 'text-green-400'
                                                                }`}>
                                                                    {transaction.type === 'expense' ? '-' : '+'}${transaction.amount.toFixed(2)}
                                                                </span>
                                                            </td>
                                                            <td className="text-center">
                                                                <div className="flex items-center justify-center gap-2">
                                                                    {transaction.recurring && (
                                                                        <Icon name="repeat" size={14} className="text-blue-400" title="Recurring" />
                                                                    )}
                                                                    <div className={`w-2 h-2 rounded-full ${
                                                                        transaction.confidence > 90 ? 'bg-green-400' :
                                                                        transaction.confidence > 70 ? 'bg-yellow-400' : 'bg-red-400'
                                                                    }`} title={`${transaction.confidence}% confidence`} />
                                                                </div>
                                                            </td>
                                                            <td className="text-center">
                                                                <div className="flex items-center justify-center gap-2">
                                                                    <button 
                                                                        onClick={() => {
                                                                            setEditingTransaction(transaction);
                                                                            setShowTransactionForm(true);
                                                                        }}
                                                                        className="p-2 hover:bg-cyan-500/20 rounded-lg transition-colors group"
                                                                        title="Edit transaction"
                                                                    >
                                                                        <Icon name="edit-2" size={14} className="text-gray-500 group-hover:text-cyan-400" />
                                                                    </button>
                                                                    <button 
                                                                        onClick={() => deleteTransaction(transaction.id)}
                                                                        className="p-2 hover:bg-red-500/20 rounded-lg transition-colors group"
                                                                        title="Delete transaction"
                                                                    >
                                                                        <Icon name="trash-2" size={14} className="text-gray-500 group-hover:text-red-400" />
                                                                    </button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                    )}
                                    
                                    {/* Pagination */}
                                    {filteredAndSortedTransactions.length > 50 && (
                                        <div className="flex items-center justify-between">
                                            <p className="text-sm text-gray-400">
                                                Showing 50 of {filteredAndSortedTransactions.length} transactions
                                            </p>
                                            <div className="flex gap-2">
                                                <button className="btn btn-ghost px-4 py-2 rounded-lg">
                                                    Previous
                                                </button>
                                                <button className="btn btn-ghost px-4 py-2 rounded-lg">
                                                    Next
                                                </button>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}
                            
                            {/* Accounts Tab */}
                            {activeTab === 'accounts' && (
                                <div className="space-y-8">
                                    <div className="flex justify-between items-center">
                                        <div>
                                            <h2 className="text-2xl font-bold text-white mb-2">Account Management</h2>
                                            <p className="text-gray-400">Monitor and manage your financial accounts</p>
                                        </div>
                                        <button className="btn btn-primary px-6 py-3 rounded-xl">
                                            <Icon name="plus-circle" size={16} className="mr-2" />
                                            Add Account
                                        </button>
                                    </div>
                                    
                                    {/* Account Overview Cards */}
                                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                        {accounts.map(account => (
                                            <div key={account.id} className="glass-dark rounded-2xl p-6 card-hover">
                                                <div className="flex items-center justify-between mb-4">
                                                    <div className="flex items-center gap-3">
                                                        <div className={`p-3 rounded-xl ${
                                                            account.type === 'checking' ? 'bg-blue-500/20 text-blue-400' :
                                                            account.type === 'savings' ? 'bg-green-500/20 text-green-400' :
                                                            'bg-purple-500/20 text-purple-400'
                                                        }`}>
                                                            <Icon name={
                                                                account.type === 'checking' ? 'credit-card' :
                                                                account.type === 'savings' ? 'piggy-bank' : 'trending-up'
                                                            } size={24} />
                                                        </div>
                                                        <div>
                                                            <h3 className="font-semibold text-white">{account.name}</h3>
                                                            <p className="text-sm text-gray-400">{account.institution}</p>
                                                        </div>
                                                    </div>
                                                    <span className="text-xs font-mono text-gray-500">{account.number}</span>
                                                </div>
                                                
                                                <div className="mb-4">
                                                    <div className="text-3xl font-bold text-white mb-2">
                                                        ${account.balance.toLocaleString()}
                                                    </div>
                                                    <div className="flex items-center gap-2">
                                                        <span className="text-green-400 text-sm font-medium">
                                                            +${account.monthlyChange.toLocaleString()}
                                                        </span>
                                                        <span className="text-gray-500 text-sm">this month</span>
                                                    </div>
                                                </div>
                                                
                                                <div className="space-y-2 mb-4">
                                                    <div className="flex justify-between text-sm">
                                                        <span className="text-gray-400">Interest Rate</span>
                                                        <span className="text-white font-medium">{account.interestRate}%</span>
                                                    </div>
                                                    <div className="flex justify-between text-sm">
                                                        <span className="text-gray-400">Account Type</span>
                                                        <span className="text-white font-medium capitalize">{account.type}</span>
                                                    </div>
                                                </div>
                                                
                                                <div className="flex gap-2">
                                                    <button className="flex-1 btn btn-outline py-2 rounded-lg text-sm">
                                                        <Icon name="eye" size={14} className="mr-1" />
                                                        View Details
                                                    </button>
                                                    <button className="flex-1 btn btn-ghost py-2 rounded-lg text-sm">
                                                        <Icon name="settings" size={14} className="mr-1" />
                                                        Settings
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                    
                                    {/* Account Activity */}
                                    <div className="glass-dark rounded-2xl p-6">
                                        <h3 className="text-xl font-semibold text-white mb-6">Recent Activity</h3>
                                        <div className="space-y-4">
                                            {transactions.slice(0, 8).map(transaction => (
                                                <div key={transaction.id} className="flex items-center justify-between py-3 border-b border-gray-800 last:border-b-0">
                                                    <div className="flex items-center gap-4">
                                                        <div className={`p-2 rounded-lg ${
                                                            transaction.type === 'income' ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'
                                                        }`}>
                                                            <Icon name={transaction.type === 'income' ? 'arrow-down-left' : 'arrow-up-right'} size={16} />
                                                        </div>
                                                        <div>
                                                            <p className="font-medium text-white">{transaction.description}</p>
                                                            <p className="text-sm text-gray-400">{transaction.date}  {transaction.account}</p>
                                                        </div>
                                                    </div>
                                                    <span className={`font-bold ${
                                                        transaction.type === 'expense' ? 'text-red-400' : 'text-green-400'
                                                    }`}>
                                                        {transaction.type === 'expense' ? '-' : '+'}${transaction.amount.toFixed(2)}
                                                    </span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {/* Budget Tab */}
                            {activeTab === 'budget' && (
                                <div className="space-y-8">
                                    <div className="flex justify-between items-center">
                                        <div>
                                            <h2 className="text-2xl font-bold text-white mb-2">Budget Planning</h2>
                                            <p className="text-gray-400">Track and manage your spending across categories</p>
                                        </div>
                                        <button 
                                            onClick={() => addNotification('Budget editing feature coming soon!', 'info', 'Coming Soon')}
                                            className="btn btn-primary px-6 py-3 rounded-xl"
                                        >
                                            <Icon name="edit-3" size={16} className="mr-2" />
                                            Edit Budgets
                                        </button>
                                    </div>
                                    
                                    {/* Budget Overview */}
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                        <div className="glass-dark rounded-2xl p-6 text-center">
                                            <h3 className="text-lg font-semibold text-white mb-2">Total Budget</h3>
                                            <div className="text-3xl font-bold text-cyan-400 mb-2">
                                                ${budgetEnvelopes.reduce((sum, e) => sum + e.budget, 0).toLocaleString()}
                                            </div>
                                            <p className="text-sm text-gray-400">Monthly allocation</p>
                                        </div>
                                        <div className="glass-dark rounded-2xl p-6 text-center">
                                            <h3 className="text-lg font-semibold text-white mb-2">Total Spent</h3>
                                            <div className="text-3xl font-bold text-yellow-400 mb-2">
                                                ${budgetEnvelopes.reduce((sum, e) => sum + e.spent, 0).toLocaleString()}
                                            </div>
                                            <p className="text-sm text-gray-400">This month</p>
                                        </div>
                                        <div className="glass-dark rounded-2xl p-6 text-center">
                                            <h3 className="text-lg font-semibold text-white mb-2">Remaining</h3>
                                            <div className="text-3xl font-bold text-green-400 mb-2">
                                                ${(budgetEnvelopes.reduce((sum, e) => sum + e.budget, 0) - 
                                                  budgetEnvelopes.reduce((sum, e) => sum + e.spent, 0)).toLocaleString()}
                                            </div>
                                            <p className="text-sm text-gray-400">Available to spend</p>
                                        </div>
                                    </div>
                                    
                                    {/* Budget Categories */}
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        {budgetEnvelopes.map(envelope => {
                                            const percentage = envelope.budget > 0 ? (envelope.spent / envelope.budget) * 100 : 0;
                                            const isOverBudget = percentage > 100;
                                            const remaining = envelope.budget - envelope.spent;
                                            
                                            return (
                                                <div key={envelope.category} className="glass-dark rounded-2xl p-6 card-hover">
                                                    <div className="flex items-center justify-between mb-4">
                                                        <div className="flex items-center gap-3">
                                                            <div className="p-2 rounded-lg" style={{ backgroundColor: envelope.color + '20', color: envelope.color }}>
                                                                <Icon name={envelope.icon} size={20} />
                                                            </div>
                                                            <div>
                                                                <h3 className="font-semibold text-white">{envelope.category}</h3>
                                                                <p className="text-sm text-gray-400">
                                                                    ${envelope.spent.toFixed(0)} of ${envelope.budget}
                                                                </p>
                                                            </div>
                                                        </div>
                                                        <div className="text-right">
                                                            <div className={`text-lg font-bold ${isOverBudget ? 'text-red-400' : 'text-green-400'}`}>
                                                                ${Math.abs(remaining).toFixed(0)}
                                                            </div>
                                                            <div className="text-xs text-gray-500">
                                                                {isOverBudget ? 'over budget' : 'remaining'}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div className="mb-4">
                                                        <div className="progress-bar">
                                                            <div
                                                                className={`progress-fill ${isOverBudget ? 'danger' : percentage > 80 ? 'warning' : ''}`}
                                                                style={{ width: `${Math.min(percentage, 100)}%` }}
                                                            />
                                                        </div>
                                                        <div className="flex justify-between text-xs text-gray-500 mt-2">
                                                            <span>0%</span>
                                                            <span className="font-bold">{percentage.toFixed(1)}%</span>
                                                            <span>100%</span>
                                                        </div>
                                                    </div>
                                                    
                                                    {isOverBudget && (
                                                        <div className="alert alert-error text-sm">
                                                            <Icon name="alert-triangle" size={16} className="text-red-400" />
                                                            <span>You've exceeded your budget by ${(envelope.spent - envelope.budget).toFixed(0)}</span>
                                                        </div>
                                                    )}
                                                </div>
                                            );
                                        })}
                                    </div>
                                    
                                    {/* Budget Insights */}
                                    <div className="glass-dark rounded-2xl p-6">
                                        <h3 className="text-xl font-semibold text-white mb-6">Budget Insights</h3>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <div>
                                                <h4 className="font-semibold text-green-400 mb-3">Top Performers</h4>
                                                <div className="space-y-2">
                                                    {budgetEnvelopes
                                                        .filter(e => e.spent < e.budget * 0.8)
                                                        .slice(0, 3)
                                                        .map(e => (
                                                            <div key={e.category} className="flex items-center gap-2">
                                                                <Icon name="check-circle" size={16} className="text-green-400" />
                                                                <span className="text-white">{e.category}</span>
                                                                <span className="text-sm text-gray-400">
                                                                    ({((e.spent / e.budget) * 100).toFixed(0)}% used)
                                                                </span>
                                                            </div>
                                                        ))}
                                                </div>
                                            </div>
                                            <div>
                                                <h4 className="font-semibold text-yellow-400 mb-3">Needs Attention</h4>
                                                <div className="space-y-2">
                                                    {budgetEnvelopes
                                                        .filter(e => e.spent > e.budget * 0.9)
                                                        .slice(0, 3)
                                                        .map(e => (
                                                            <div key={e.category} className="flex items-center gap-2">
                                                                <Icon name="alert-circle" size={16} className="text-yellow-400" />
                                                                <span className="text-white">{e.category}</span>
                                                                <span className="text-sm text-gray-400">
                                                                    ({((e.spent / e.budget) * 100).toFixed(0)}% used)
                                                                </span>
                                                            </div>
                                                        ))}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {/* Other tabs show coming soon message */}
                            {!['dashboard', 'transactions', 'accounts', 'budget'].includes(activeTab) && (
                                <div className="text-center py-20">
                                    <Icon name={tabs.find(t => t.id === activeTab)?.icon || 'layout-dashboard'} size={80} className="text-cyan-400 mx-auto mb-8 opacity-50" />
                                    <h3 className="text-3xl font-bold text-white mb-4">
                                        {tabs.find(t => t.id === activeTab)?.label} Module
                                    </h3>
                                    <p className="text-xl text-gray-400 mb-8 max-w-2xl mx-auto">
                                        Advanced {tabs.find(t => t.id === activeTab)?.label.toLowerCase()} management and analytics features are coming soon. 
                                        This will include comprehensive tools for {tabs.find(t => t.id === activeTab)?.description.toLowerCase()}.
                                    </p>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                                        {[
                                            { 
                                                title: "Advanced Analytics", 
                                                description: "Deep insights and predictive modeling",
                                                icon: "bar-chart-3"
                                            },
                                            { 
                                                title: "Smart Automation", 
                                                description: "AI-powered recommendations and actions",
                                                icon: "zap"
                                            },
                                            { 
                                                title: "Real-time Sync", 
                                                description: "Live data integration with your accounts",
                                                icon: "refresh-cw"
                                            }
                                        ].map((feature, index) => (
                                            <div key={index} className="glass-dark rounded-2xl p-6 text-center">
                                                <div className="w-16 h-16 bg-gradient-to-br from-cyan-500/20 to-purple-500/20 rounded-2xl flex items-center justify-center mx-auto mb-4">
                                                    <Icon name={feature.icon} size={32} className="text-cyan-400" />
                                                </div>
                                                <h4 className="text-lg font-semibold text-white mb-2">{feature.title}</h4>
                                                <p className="text-sm text-gray-400">{feature.description}</p>
                                            </div>
                                        ))}
                                    </div>
                                    
                                    <div className="mt-12">
                                        <button 
                                            onClick={() => addNotification('Thanks for your interest! We\'ll notify you when this feature is ready.', 'info', 'Feature Request')}
                                            className="btn btn-primary px-8 py-4 rounded-xl text-lg"
                                        >
                                            <Icon name="bell" size={20} className="mr-2" />
                                            Notify Me When Ready
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                        
                        {/* Enhanced Footer */}
                        <div className="glass rounded-3xl p-6 mt-8 text-center">
                            <div className="flex flex-col md:flex-row items-center justify-between gap-4">
                                <div className="text-left">
                                    <p className="text-lg font-semibold text-gradient mb-1">
                                        Personal Finance Command Center
                                    </p>
                                    <p className="text-sm text-gray-500">
                                        Professional Edition  2024 | Advanced Financial Analytics & Management
                                    </p>
                                </div>
                                
                                <div className="flex items-center gap-6 text-sm text-gray-400">
                                    <span className="flex items-center gap-1">
                                        <Icon name="shield-check" size={14} />
                                        Secure
                                    </span>
                                    <span className="flex items-center gap-1">
                                        <Icon name="activity" size={14} />
                                        Live Data
                                    </span>
                                    <span className="flex items-center gap-1">
                                        <Icon name="cpu" size={14} />
                                        AI-Powered
                                    </span>
                                </div>
                                
                                <div className="text-xs font-mono text-gray-600">
                                    v2.0.0 - Build {new Date().getTime().toString().slice(-6)}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {/* Enhanced Transaction Form Modal */}
                    <TransactionForm
                        isOpen={showTransactionForm}
                        onClose={() => {
                            setShowTransactionForm(false);
                            setEditingTransaction(null);
                        }}
                        onSave={editingTransaction ? updateTransaction : addTransaction}
                        editTransaction={editingTransaction}
                    />
                </div>
            );
        };
        
        // Render the application with error boundary
        const App = () => (
            <ErrorBoundary>
                <FinanceCommandCenter />
            </ErrorBoundary>
        );
        
        // Safe rendering with error handling
        try {
            ReactDOM.render(<App />, document.getElementById('root'));
        } catch (renderError) {
            console.error('Failed to render application:', renderError);
            // Fallback rendering
            document.getElementById('root').innerHTML = `
                <div style="min-height: 100vh; background: #0a0a0a; display: flex; align-items: center; justify-content: center; color: white; text-align: center; padding: 2rem;">
                    <div>
                        <h1 style="color: #00ffff; margin-bottom: 1rem;">Application Error</h1>
                        <p style="color: #888; margin-bottom: 2rem;">Failed to load the Personal Finance Command Center</p>
                        <button onclick="window.location.reload()" style="background: linear-gradient(135deg, #00ffff, #0080ff); color: black; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                            Reload Application
                        </button>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
